# 苍穹外卖

## 开发环境搭建

### 使用git管理项目

![image-20231003183405125](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20231003183405125.png)

### 前后端联调

![image-20231003183446606](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20231003183446606.png)



### nginx转发

![image-20231003183526122](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20231003183526122.png)

![image-20231003183542334](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20231003183542334.png)



![image-20231003183650044](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003183650044.png)





#### nginx反向代理配置

![image-20231003183817421](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003183817421.png)



#### nginx负载均衡配置

![image-20231003183855090](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003183855090.png)

![image-20231003183937901](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003183937901.png)





### 完善登录功能

![image-20231003184054189](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003184054189.png)

![image-20231003184102502](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003184102502.png)



![image-20231003184117245](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003184117245.png)

![image-20231003184337842](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003184337842.png)



### 导入接口文档

![image-20231003195752092](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003195752092.png)



### swagger

![image-20231003201121845](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003201121845.png)

![image-20231003201607213](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003201607213.png)



## 员工管理

### 新增员工

#### 需求分析与设计

![image-20231003202130309](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003202130309.png)



#### 代码开发

![image-20231003203657821](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003203657821.png)



- 使用@RequestBody注解就可以接受来自前端的json格式的参数，使用EmployeeDTO而不直接使用Employee实体类是因为前端传来的参数和实体类差距较大，使用EmployeeDTO中转一下

```java
  /**
     * 新增员工
     */
    @PostMapping
    public Result save(@RequestBody EmployeeDTO employeeDTO){
        employeeService.save(employeeDTO);
        return Result.success();
    }
```



```java
  /**
     * 新增员工
     * @param employeeDTO
     */
    @Override
    public void save(EmployeeDTO employeeDTO) {
        Employee employee = new Employee();

        //对象属性拷贝
        BeanUtils.copyProperties(employeeDTO,employee);

        //设置账号状态，0：锁定 1：正常
        employee.setStatus(StatusConstant.ENABLE);
        //设置用户密码，默认密码为123456，使用md5加密
        employee.setPassword(DigestUtils.md5DigestAsHex(PasswordConstant.DEFAULT_PASSWORD.getBytes()));
        //设置记录时间和修改时间
        employee.setCreateTime(LocalDateTime.now());
        employee.setUpdateTime(LocalDateTime.now());

        //设置当前创建人和修改人的id
        // TODO 后期要改为登录用户的id
        employee.setCreateUser(10L);
        employee.setUpdateUser(10L);

        employeeMapper.insert(employee);

    }
```



#### 代码完善



![image-20231003212216556](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003212216556.png)

```java
/**
     * 处理SQL异常
     * @param ex
     * @return
     */
    @ExceptionHandler
    public Result exceptionHandler(SQLIntegrityConstraintViolationException ex){
        //Duplicate entry 'zhangsan' for key 'idx_username'
        String message = ex.getMessage();
        if(message.contains("Duplicate entry")) {
            String[] s = message.split(" ");
            String userName = s[2];
            String msg = userName + MessageConstant.ALREADY_EXISTS;
            return Result.error(msg);
        }else{
            return Result.error(MessageConstant.UNKNOWN_ERROR);
        }

    }

```



![image-20231003213307442](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003213307442.png)





![image-20231003213405765](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003213405765.png)

![image-20231003213355526](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231003213355526.png)

### 员工分页查询

#### 需求分析与设计

![image-20231006163522426](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006163522426.png)

![image-20231006163543005](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006163543005.png)



#### 代码开发

![image-20231006163621321](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006163621321.png)

![image-20231006163644564](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006163644564.png)

```java
/**
     * 员工分页查询
     * @param employeePageQueryDTO
     * @return
     */
    @GetMapping("/page")
    @ApiOperation("员工分页查询")
    public Result<PageResult> page(EmployeePageQueryDTO employeePageQueryDTO){
        log.info("员工分页查询,参数为"+employeePageQueryDTO);
        PageResult pageResult = employeeService.pageQuery(employeePageQueryDTO);
        return Result.success(pageResult);
    }
```



```java
 /**
     * 分页查询员工
     * @param employeePageQueryDTO
     * @return
     */
    @Override
    public PageResult pageQuery(EmployeePageQueryDTO employeePageQueryDTO) {
        //开始分页查询，借助PageHelper插件快速完成
        PageHelper.startPage(employeePageQueryDTO.getPage(),employeePageQueryDTO.getPageSize());
        //进行查询，这里的sql就不用写limit了因为PageHelper会帮我们动态添加limit
        Page<Employee> page = employeeMapper.pageQuery(employeePageQueryDTO);
        PageResult pageResult = new PageResult(page.getTotal(),page.getResult());
        return pageResult;
    }
```

```xml
  <select id="pageQuery" resultType="com.sky.entity.Employee">
        select * from employee
        <where>
            <if test="name !=null and name != ''">
                and name like concat('%',#{name},'%')
            </if>
        </where>
        order by create_time desc
    </select>
```



####　功能完善

- java中的localdatetime转化为json格式会变成字符串数组，这样前端显示就会有问题，这里给他限定格式，“yyyy-MM-dd HH:mm:ss”

![image-20231006163934255](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006163934255.png)



###　启用禁用员工账号

#### 需求设计与分析

![image-20231006164848404](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006164848404.png)

![image-20231006164840573](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006164840573.png)

![image-20231006164856285](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006164856285.png)



#### 代码开发

```java
    @PostMapping("/status/{status}")
    @ApiOperation("启用禁用员工账号")
    public Result startOrStop(@PathVariable("status") Integer status,Long id){
        log.info("启用禁用账号，{},{}",status,id);
        employeeService.startOrStop(status,id);
        return Result.success();
    }
```



```java
/**
     * 启用禁用员工账号
     * @param status
     * @param id
     */
    @Override
    public void startOrStop(Integer status, Long id) {
        Employee employee = Employee.builder()
                                    .id(id)
                                    .status(status)
                                    .build();
        employeeMapper.update(employee);
    }
```



### 编辑员工

#### 需求分析与设计

![image-20231006184425014](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006184425014.png)

![image-20231006184436105](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006184436105.png)



#### 代码开发

 ```java
  /**
      * 根据id查询用户信息
      * @param id
      * @return
      */
     @GetMapping("/{id}")
     @ApiOperation("根据id查询用户信息")
     public Result<Employee> getById(@PathVariable("id") Long id){
         Employee employee = employeeService.getById(id);
         return Result.success(employee);
     }
 
     /**
      * 编辑员工信息
      * @param employeeDTO
      * @return
      */
     @PutMapping
     @ApiOperation("编辑员工信息")
     public Result update(@RequestBody EmployeeDTO employeeDTO){
         employeeService.update(employeeDTO);
         return Result.success();
     }
 
 ```



```java
 /**
     * 根据id查询用户信息
     * @param id
     * @return
     */
    @Override
    public Employee getById(Long id) {
        Employee employee = employeeMapper.getById(id);
        //将密码隐藏，加强安全性
        employee.setPassword("****");
        return employee;
    }

    /**
     * 编辑员工信息
     * @param employeeDTO
     */
    @Override
    public void update(EmployeeDTO employeeDTO) {
        Employee employee = new Employee();
        //将数据拷贝到新的emp中
        BeanUtils.copyProperties(employeeDTO,employee);

        //设置更新时间和更新人
        employee.setUpdateTime(LocalDateTime.now());
        employee.setUpdateUser(BaseContext.getCurrentId());
        //调用mapper进行更新
        employeeMapper.update(employee);
    }
```





## 菜品管理

### 公共字段自动填充

#### 问题分析

![image-20231006202113490](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006202113490.png)

![image-20231006202327568](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231006202327568.png)



### 新增菜品

#### 需求分析与设计

![image-20231019193221957](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231019193221957.png)

![image-20231019193252266](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231019193252266.png)

![image-20231019193343580](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231019193343580.png)

![image-20231019193457406](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231019193457406.png)





#### 代码开发

##### 文件上传

```java
package com.sky.controller.admin;


import com.sky.constant.MessageConstant;
import com.sky.result.Result;
import com.sky.utils.AliOssUtil;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.multipart.MultipartFile;

import java.io.IOException;
import java.util.UUID;

/**
 * 通用接口
 */
@RestController
@RequestMapping("/admin/common")
@Api(tags = "通用接口")
@Slf4j
public class CommonController {

    @Autowired
    private AliOssUtil aliOssUtil;

    @PostMapping("/upload")
    @ApiOperation("文件上传")
    public Result<String> upload(MultipartFile file) {
        log.info("文件上传:{}", file);

        try {
            String originalFilename = file.getOriginalFilename();//获取原始文件名
            String extension = originalFilename.substring(originalFilename.lastIndexOf("."));
            String objName = UUID.randomUUID().toString() + extension; //通过UUID+后缀获得文件名，这样就不会重名

            //filePath文件请求路径
            String filePath = aliOssUtil.upload(file.getBytes(), objName);

            return Result.success(filePath);
        } catch (IOException e) {
            log.error("文件上传失败 {}", e);
        }
        return Result.error(MessageConstant.UPLOAD_FAILED);

    }
}

```





##### 新增菜品

- dishController

```java
package com.sky.controller.admin;

import com.sky.dto.DishDTO;
import com.sky.result.Result;
import com.sky.service.DishService;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

/**
 * 菜品管理
 */
@RestController
@RequestMapping("/admin/dish")
@Slf4j
@Api(tags = "菜品相关接口")
public class DishController {

    @Autowired
    private DishService dishService;

    @PostMapping
    @ApiOperation("新增菜品")
    public Result save(@RequestBody DishDTO dishDTO){
        log.info("新增菜品 {}",dishDTO);
        dishService.saveWishFlavor(dishDTO);

        return Result.success();
    }
}

```



- dishservice

```java
package com.sky.service;

import com.sky.dto.DishDTO;

public interface DishService {

    /**
     * 新增菜品和对应的口味数据
     * @param dishDTO
     */
    void saveWishFlavor(DishDTO dishDTO);
}

```



- dishserviceImpl

```java
package com.sky.service.impl;

import com.sky.dto.DishDTO;
import com.sky.entity.Dish;
import com.sky.entity.DishFlavor;
import com.sky.mapper.DishFlavorMapper;
import com.sky.mapper.DishMapper;
import com.sky.service.DishService;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Service
@Slf4j
public class DishServiceImpl implements DishService {

    @Autowired
    private DishMapper dishMapper;

    @Autowired
    private DishFlavorMapper dishFlavorMapper;

    /**
     * 新增菜品和对应的口味数据
     * @param dishDTO
     */
    @Override
    @Transactional //因为要操作两张表，所以加一个事务注解，保证数据一致性
    public void saveWishFlavor(DishDTO dishDTO) {
        //向菜品表插入1条数据
        Dish dish = new Dish(); //菜品表当中没有口味信息，这里就才有一个Dish实体类传递
        BeanUtils.copyProperties(dishDTO,dish); //使用BeanUtils进行对象属性拷贝
        dishMapper.insert(dish);  //调用Mapper完成数据库操作


        //由于前端无法传递过来菜品的id，菜品id是自增的，所以这里要获取一下插入时的id，这样才可以顺利插入口味信息
        //这里可以直接从dish当中获取出来id是因为在DishMapper.xml当中添加了keyProperty="id"，这个会将添加时的id赋给传入的实体类
        Long dishId = dish.getId();

        //先获取到口味的集合
        List<DishFlavor> flavors = dishDTO.getFlavors();
        if(flavors!=null&&flavors.size()>0){
            //遍历flavors给每个口味的dishId赋值
            flavors.forEach(dishFlavor -> {
                dishFlavor.setDishId(dishId);
            });
            //向口味表插入n条数据
            dishFlavorMapper.insertBatch(flavors);
        }

    }
}

```



- dishMapper

```java
package com.sky.mapper;

import com.sky.annotation.AutoFill;
import com.sky.dto.DishDTO;
import com.sky.entity.Dish;
import com.sky.enumeration.OperationType;
import org.apache.ibatis.annotations.Insert;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Select;

@Mapper
public interface DishMapper {

    /**
     * 根据分类id查询菜品数量
     * @param categoryId
     * @return
     */
    @Select("select count(id) from dish where category_id = #{categoryId}")
    Integer countByCategoryId(Long categoryId);

    /**
     * 插入菜品，由于字段较多，这里就采用xml的形式
     * @param dish
     */
    @AutoFill(value = OperationType.INSERT)
    void insert(Dish dish);
}

```



- dishMapper.xml

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sky.mapper.DishMapper">


    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        insert into dish (name, category_id, price, image, description, create_time, update_time, create_user, update_user,status)
            VALUES (#{name},#{categoryId},#{price},#{image},#{description},#{createTime},#{updateTime},#{createUser},#{updateUser},#{status})
    </insert>
</mapper>

```



- dishFlavorMapper

```java
package com.sky.mapper;

import com.sky.entity.DishFlavor;
import org.apache.ibatis.annotations.Mapper;

import java.util.List;

@Mapper
public interface DishFlavorMapper {

    /**
     * 批量插入口味数据
     * @param flavors
     */
    void insertBatch(List<DishFlavor> flavors);
}

```



- dishFlavorMapper.xml

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sky.mapper.DishFlavorMapper">


    <insert id="insertBatch">
        insert into dish_flavor (dish_id, name, value) VALUES
        <foreach collection="flavors" item="df" separator=",">
            (#{df.dishId},#{df.name},#{df.value})
        </foreach>
    </insert>
</mapper>

```



### 菜品分页查询

#### 需求分析与设计

![image-20231019234455143](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231019234455143.png)

![image-20231019234511368](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231019234511368.png)

![image-20231019234520138](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231019234520138.png)









#### 代码开发

![image-20231019234611041](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231019234611041.png)

![image-20231019234633383](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231019234633383.png)





```java

    @GetMapping("/page")
    @ApiOperation("菜品分页查询")
    public Result<PageResult> page(DishPageQueryDTO dishPageQueryDTO){
        log.info("菜品分页查询，{}",dishPageQueryDTO);
        PageResult pageResult = dishService.pageQuery(dishPageQueryDTO);

        return Result.success(pageResult);
    }
```



```java

    /**
     * 菜品分页查询
     * @param dishPageQueryDTO
     * @return
     */
    @Override
    public PageResult pageQuery(DishPageQueryDTO dishPageQueryDTO) {
        PageHelper.startPage(dishPageQueryDTO.getPage(),dishPageQueryDTO.getPageSize());
        Page<DishVO> page = dishMapper.pageQuery(dishPageQueryDTO);
        return new PageResult(page.getTotal(),page.getResult());
    }
```





```xml
 <select id="pageQuery" resultType="com.sky.vo.DishVO">
        select d.*,c.name as categoryName from dish d left join category c on c.id = d.category_id
        <where>
            <if test="categoryId != null">
                and d.category_id = #{categoryId}
            </if>
            <if test="status != null">
                and d.status = #{status}
            </if>
        </where>
        order by d.create_time desc
    </select>
```





### 删除菜品

#### 需求分析与设计

![image-20231021131917913](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231021131917913.png)

![image-20231021131922648](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231021131922648.png)

![image-20231021131932216](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231021131932216.png)

![image-20231021131954308](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231021131954308.png)





#### 代码开发

```java
 @DeleteMapping
    @ApiOperation("菜品批量删除")
    public Result delete(@RequestParam List<Long> ids){  //前端传来的是“1,2,3”这样的字符串，原始写法是用String接受然后自己解析，这里可以让spring帮我们解析，带上@RequestParam然后用集合接受就行了
        log.info("菜品批量删除,{}",ids);
        dishService.deleteBatch(ids);
        return Result.success();
    }
```







```java
 /**
     * 菜品批量删除
     * @param ids
     */
    @Override
    public void deleteBatch(List<Long> ids) {
        //判断当前菜品是否能够删除--是否存在起售中的菜品
        for (Long id : ids) {
            Dish dish = dishMapper.getById(id);
            if (dish.getStatus() == StatusConstant.ENABLE){
                //当前菜品在起售状态，不能删除
                throw new DeletionNotAllowedException(MessageConstant.DISH_ON_SALE);
            }
        }

        //判断当前菜品是否能够删除--当前菜品是否被套餐关联
        List<Long> setmealIds = setmealDishMapper.getSetmealIdsByDishIds(ids);
        if(setmealIds!=null&&setmealIds.size()>0){
            //当前菜品被套餐关联了不能删除
            throw new DeletionNotAllowedException(MessageConstant.DISH_BE_RELATED_BY_SETMEAL);
        }

//        //删除菜品表中的菜品数据
//        for (Long id : ids) {
//            dishMapper.deleteById(id);
//            //删除菜品关联的口味数据
//            dishFlavorMapper.deleteByDishId(id);
//        }

        //根据id集合批量删除菜品数据（对上面的循环的方式进行优化，减少sql的发送量）
        dishMapper.deleteByIds(ids);
        //根据id集合批量删除口味数据（对上面的循环的方式进行优化，减少sql的发送量）
        dishFlavorMapper.deleteByIds(ids);
    }
```



```xml
 <select id="getSetmealIdsByDishIds" resultType="java.lang.Long">
        select setmeal_id from setmeal_dish where dish_id in 
        <foreach collection="dishIds" item="dishId" separator="," open="(" close=")">
            #{dishId}
        </foreach>
    </select>
```



### 修改菜品

#### 需求分析与设计

![image-20231021135735352](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231021135735352.png)

![image-20231021135807314](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231021135807314.png)

![image-20231021135832600](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231021135832600.png)

![image-20231021135901829](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231021135901829.png)



#### 代码开发

```java
  @GetMapping("/{id}")   //用于回显
    @ApiOperation("根据id查询菜品")
    public Result<DishVO> getById(@PathVariable Long id){
        log.info("根据id查询菜品,{}",id);
        DishVO dishVO = dishService.getByIdWithFlavor(id);
        return Result.success(dishVO);
    }


/**
     * 修改菜品
     * @param dishDTO
     * @return
     */
    @PutMapping
    @ApiOperation("修改菜品")
    public Result update(@RequestBody DishDTO dishDTO){
        log.info("修改菜品: {}",dishDTO);
        dishService.updateWithFlavor(dishDTO);
        return Result.success();
    }
```



```java
/**
     * 根据id查询菜品和对应的口味数据
     * @param id
     * @return
     */
    @Override
    public DishVO getByIdWithFlavor(Long id) {
        //根据id查询菜品数据
        Dish dish = dishMapper.getById(id);

        //根据菜品id查询口味数据
        List<DishFlavor> dishFlavors = dishFlavorMapper.getByDishId(id);

        //封装DishVO
        DishVO dishVO = new DishVO();
        BeanUtils.copyProperties(dish,dishVO);
        dishVO.setFlavors(dishFlavors);

        return dishVO;
    }

    /**
     * 根据id修改菜品及其关联的口味信息
     * @param dishDTO
     */
    @Override
    public void updateWithFlavor(DishDTO dishDTO) {
        Dish dish = new Dish();
        BeanUtils.copyProperties(dishDTO,dish);

        //修改菜品表的基本信息
        dishMapper.update(dish);
        //删除原有的口味数据
        dishFlavorMapper.deleteByDishId(dishDTO.getId());
        //插入新的口味数据
        List<DishFlavor> flavors = dishDTO.getFlavors();
        if(flavors!=null&&flavors.size()>0){
            flavors.forEach(dishFlavor -> {
                dishFlavor.setDishId(dishDTO.getId());
            });
            dishFlavorMapper.insertBatch(flavors);
        }

    }
```



```xml
   <update id="update">
        update dish 
        <set>
            <if test="name != null">
                name = #{name},
            </if>
            <if test="categoryId != null">
                category_id = #{categoryId},
            </if>
            <if test="price != null">
                price = #{price},
            </if>
            <if test="image != null">
                image = #{image},
            </if>
            <if test="description != null">
                description = #{description},
            </if>
            <if test="status != null">
                status = #{status},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime},
            </if>
            <if test="updateUser != null">
                update_user = #{updateUser},
            </if>
        </set>
        where id = #{id}
    </update>
```



## Redis

### 入门

![image-20231022113928757](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022113928757.png)





#### 命令行开启服务

![image-20231022115215974](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022115215974.png)



#### 命令行访问redis

![image-20231022115147481](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022115147481.png)







### Redis数据类型

![image-20231022161532634](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022161532634.png)

![image-20231022161808048](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022161808048.png)



### Redis常用操作命令

- ！！！！！注意，Redis当中的字符串类型和Java不对应，在java操作redis时使用字符串操作可以传入对象，在redis当中会存放java对象序列化后的字符串，取出来时在将其强转为放入时的对象即可

#### 字符串操作命令

![image-20231022162016891](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022162016891.png)



#### 哈希操作命令

![image-20231022162412221](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022162412221.png)



#### 列表操作命令

![image-20231022162742349](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022162742349.png)



#### 集合操作命令

![image-20231022163700359](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022163700359.png)



#### 有序集合操作命令

**![image-20231022164047280](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022164047280.png)**



#### 通用命令

![image-20231022164531127](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022164531127.png)

### java操作Redis

#### Redis的java客户端

![image-20231022164907403](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022164907403.png)

#### Spring Data Redis方式

![image-20231022165037922](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022165037922.png)

![image-20231022165047844](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022165047844.png)





##### 配置数据源

```yaml
spring:
  redis:
    host: localhost
    port: 6379
    password: 123456
    database: 10
```



##### 编写配置类

```java
package com.sky.config;

import lombok.extern.slf4j.Slf4j;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.StringRedisSerializer;

@Configuration
@Slf4j
public class RedisConfiguration {
    @Bean
    public RedisTemplate redisTemplate(RedisConnectionFactory redisConnectionFactory){
        log.info("开始创建redis模板对象...");
        RedisTemplate redisTemplate = new RedisTemplate();
        //设置redis的连接工厂对象
        redisTemplate.setConnectionFactory(redisConnectionFactory);
        //设置redis key的序列化器
        redisTemplate.setKeySerializer(new StringRedisSerializer());
        return redisTemplate;
    }
}

```



##### 通过RedisTemplate对象操作Redis



```java
package com.sky.test;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.redis.connection.DataType;
import org.springframework.data.redis.core.*;

import java.util.List;
import java.util.Set;
import java.util.concurrent.TimeUnit;

@SpringBootTest
public class SpringDateRedisTest {
    @Autowired
    private RedisTemplate redisTemplate;

    @Test
    public void testRedisTemplate(){
        System.out.println(redisTemplate);
        //获取不同的数据类型的对象
        ValueOperations valueOperations = redisTemplate.opsForValue();
        HashOperations hashOperations = redisTemplate.opsForHash();
        ListOperations listOperations = redisTemplate.opsForList();
        SetOperations setOperations = redisTemplate.opsForSet();
        ZSetOperations zSetOperations = redisTemplate.opsForZSet();

    }

    /**
     * 操作字符串类型数据
     */
    @Test
    public void testString(){
        //set
        redisTemplate.opsForValue().set("city","北京");
        //get
        String city = (String) redisTemplate.opsForValue().get("city");
        System.out.println(city);
        //setex
        redisTemplate.opsForValue().set("city","广东",3, TimeUnit.MINUTES); //这里和命令行操作不一样，直接是在set里面加参数，后面跟着TimeUnit.MINUTES指定单位
        //setnx
        redisTemplate.opsForValue().setIfAbsent("code",1);
        redisTemplate.opsForValue().setIfAbsent("code",2);
    }


    /**
     * 操作Hash类型数据
     */
    @Test
    public void testHash(){
        HashOperations hashOperations = redisTemplate.opsForHash();
        //hset
        hashOperations.put("100","name","Tom");
        hashOperations.put("100","age","20");

        //hget
        String name = (String) hashOperations.get("100", "name");
        System.out.println(name);

        //hkeys
        Set keys = hashOperations.keys("100");
        System.out.println(keys);

        //hval
        List values = hashOperations.values("100");
        System.out.println(values);

        //hdel
        hashOperations.delete("100","age");

    }

    /**
     * 操作列表类型数据
     */
    @Test
    public void testList(){
        ListOperations listOperations = redisTemplate.opsForList();
        //lpush
        listOperations.leftPushAll("mylist","a","b","c");
        listOperations.leftPush("mylist","d");

        //lrange
        List mylist = listOperations.range("mylist", 0, -1);
        System.out.println(mylist);

        //rpop
        listOperations.rightPop("mylist");

        //llen
        Long len = listOperations.size("mylist");
        System.out.println(len);

    }

    /**
     * 操作集合类型数据
     */
    @Test
    public void testSet(){
        SetOperations setOperations = redisTemplate.opsForSet();
        //sadd
        setOperations.add("set1","100");
        setOperations.add("set1","110");
        setOperations.add("set2","110");
        setOperations.add("set2","120");

        //smembers
        Set set1 = setOperations.members("set1");
        System.out.println(set1);

        //scard
        Long size = setOperations.size("set1");
        System.out.println(size);

        //sinter交集
        Set intersect = setOperations.intersect("set1", "set2");
        System.out.println(intersect);

        //union并集
        Set union = setOperations.union("set1", "set2");
        System.out.println(union);

        //srem
        setOperations.remove("set1","100","110");
    }


    /**
     * 操作有序集合类型数据
     */
    @Test
    public void testZset(){
        ZSetOperations zSetOperations = redisTemplate.opsForZSet();
        //zadd
        zSetOperations.add("zset1","a",10);
        zSetOperations.add("zset1","b",12);
        zSetOperations.add("zset1","c",9);

        //zrange
        Set zset1 = zSetOperations.range("zset1", 0, -1);
        System.out.println(zset1);

        //zincrby
        zSetOperations.incrementScore("zset1","c",10);

        Set s = zSetOperations.rangeWithScores("zset1", 0, -1);
        System.out.println(s);

        zSetOperations.remove("zset1","a","b");
    }

    /**
     * 通用命令操作
     */
    @Test
    public void testCommon(){
        //keys
        Set keys = redisTemplate.keys("*");
        System.out.println(keys);

        //exists
        Boolean name = redisTemplate.hasKey("name");
        System.out.println(name);

        //type
        for (Object key : keys) {
            DataType type = redisTemplate.type(key);
            System.out.println(type.name());
        }

        //del
        redisTemplate.delete("mylist");
    }
}

```





## 店铺营业状态设置

### 需求分析与设计

![image-20231022195537449](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022195537449.png)

![image-20231022195638581](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022195638581.png)

![image-20231022195837150](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022195837150.png)

![image-20231022195843941](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022195843941.png)

![image-20231022195915426](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022195915426.png)

### 代码开发

```java
package com.sky.controller.admin;

import com.sky.result.Result;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.ValueOperations;
import org.springframework.web.bind.annotation.*;

@RestController("adminShopController") //这里由于user端和admin端的controller重名了采用默认的方式会有两个同名的bean冲突所以在这里指定这个Controller的bean名称
@RequestMapping("/admin/shop")
@Api(tags = "店铺相关接口")
@Slf4j
public class ShopController {

    public static final String KEY = "SHOP_STATUS";

    @Autowired
    private RedisTemplate redisTemplate;

    /**
     * 设置店铺营业状态
     * @param status
     * @return
     */
    @PutMapping("/{status}")
    @ApiOperation("设置店铺营业状态")
    public Result setStatus(@PathVariable Integer status){   //restful格式路径参数接受
        log.info("设置店铺营业状态为：{}",status==1?"营业中":"打样中");
        redisTemplate.opsForValue().set(KEY,status);  //使用Redis进行存储
        return Result.success();
    }

    /**
     * 获取店铺营业状态
     * @return
     */
    @GetMapping("/status")
    @ApiOperation("获取店铺营业状态")
    public Result<Integer> getStatus(){
        Integer status = (Integer) redisTemplate.opsForValue().get(KEY);  //从Redis中获取店铺营业状态数据
        log.info("获取店铺营业状态为，{}",status==1?"营业中":"打样中");
        return Result.success(status);
    }

}

```



```java
package com.sky.config;

import lombok.extern.slf4j.Slf4j;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.StringRedisSerializer;

@Configuration
@Slf4j
public class RedisConfiguration {
    @Bean
    public RedisTemplate redisTemplate(RedisConnectionFactory redisConnectionFactory){
        log.info("开始创建redis模板对象...");
        RedisTemplate redisTemplate = new RedisTemplate();
        //设置redis的连接工厂对象
        redisTemplate.setConnectionFactory(redisConnectionFactory);
        //设置redis key的序列化器
        redisTemplate.setKeySerializer(new StringRedisSerializer());
        return redisTemplate;
    }
}

```



## HttpClient

![image-20231022215148877](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022215148877.png)



### 使用方式

```java
package com.sky.test;

import org.apache.http.HttpEntity;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClients;
import org.apache.http.util.EntityUtils;
import org.json.JSONObject;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
public class HttpClientTest {

    /**
     * 测试通过HttpClient发送GET方式请求
     */
    @Test
    public void testGET() throws Exception{
        //创建HttpClient对象
        CloseableHttpClient httpClient = HttpClients.createDefault();

        //创建HttpGet对象
        HttpGet httpGet = new HttpGet("http://localhost:8080/user/shop/status");

        //发送请求，接受响应结果
        CloseableHttpResponse response = httpClient.execute(httpGet);

        //处理响应结果
        int statusCode = response.getStatusLine().getStatusCode();
        System.out.println("服务端返回的状态码为"+statusCode);

        HttpEntity entity = response.getEntity();
        String body = EntityUtils.toString(entity);
        System.out.println("服务端返回的数据为"+body);

        //关闭资源
        response.close();
        httpClient.close();
    }



    /**
     * 测试通过HttpClient发送POST方式请求
     */
    @Test
    public void testPOST() throws Exception{
        //创建httpClient对象
        CloseableHttpClient httpClient = HttpClients.createDefault();

        //创建请求对象
        HttpPost httpPost = new HttpPost("http://localhost:8080/admin/employee/login");

        JSONObject jsonObject = new JSONObject();
        jsonObject.put("username","admin");
        jsonObject.put("password","123456");

        StringEntity entity = new StringEntity(jsonObject.toString());
        //指定请求编码格式
        entity.setContentEncoding("utf-8");
        //指定数据格式
        entity.setContentType("application/json");

        httpPost.setEntity(entity);


        //发送请求
        CloseableHttpResponse response = httpClient.execute(httpPost);

        //处理响应结果
        int statusCode = response.getStatusLine().getStatusCode();
        System.out.println("服务端返回的状态码为"+statusCode);

        HttpEntity entity1 = response.getEntity();
        String body = EntityUtils.toString(entity1);
        System.out.println("服务端返回的数据为"+body);

        //关闭资源
        response.close();
        httpClient.close();

    }



}

```



## 微信小程序开发

### 入门案例

![image-20231022232350704](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022232350704.png)



![image-20231022232402476](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022232402476.png)



![image-20231022232532090](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022232532090.png)



- 在wxml文件中编辑布局（类似html）

```xml
<!--index.wxml-->
<navigation-bar title="test" back="{{false}}" color="black" background="#FFF"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <view>
      {{msg}}
    </view>
    <view>
      <button bind:tap="getUserInfo" type="primary">获取用户信息</button>
      
      昵称：{{nickName}}
      <image style="width: 100px;height: 100px;" src="{{url}}"></image>
    </view>

    <view>
      <button bind:tap="wxLogin" type="warn">微信登录</button>
      授权码：{{code}}
    </view>

    <view>
      <button bind:tap="sendRequest" type="default">发送请求</button>
    </view>

  </view>
 
</scroll-view>

```

- 在js文件中编辑逻辑

```javascript
// index.js
Page({
  data:{  //data给前端提供数据，前端就可以通过{{msg}}的形式获取到数据
    msg:'hello,world',
    nickName:'',
    url:'',
    code:''
  },
  //获取微信用户头像和昵称
  getUserInfo(){
    wx.getUserProfile({
      desc: '获取用户信息',
      success:(res)=>{
        console.log(res.userInfo)
        //为数据赋值，自带的方法
        this.setData({
          nickName: res.userInfo.nickName,
          url: res.userInfo.avatarUrl
        })
      }
    })
  },
  //微信登录，获取微信用户的授权码
  wxLogin(){
    wx.login({
      success: (res) => {
       console.log(res.code) //获取授权码
       this.setData({   
         code: res.code
       })
      }
    })
  },
  //发送请求
  sendRequest(){
    wx.request({
      url: 'http://localhost:8080/user/shop/status',
      method:'GET',
      success: (res)=>{
        console.log(res.data)//这里的data代表着整个json对象
      }
    })
  }


})

```









### 发布小程序

- 点击上传

![image-20231022235452408](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022235452408.png)

- 在官网的版本管理可以看到上传的开发版本，提交审核后通过后就可以发布为线上版本

![image-20231022235508379](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022235508379.png)

![image-20231022235521821](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231022235521821.png)



## 微信登录

### 登录流程

![image-20231023230931257](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231023230931257.png)



### 需求分析与设计

![image-20231023231138524](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231023231138524.png)

![image-20231023231341080](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231023231341080.png)

![image-20231023231357979](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231023231357979.png)



### 代码开发

![image-20231023231450859](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231023231450859.png)

![image-20231023231941875](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231023231941875.png)





```java
package com.sky.controller.user;

import com.sky.constant.JwtClaimsConstant;
import com.sky.dto.UserLoginDTO;
import com.sky.entity.User;
import com.sky.properties.JwtProperties;
import com.sky.result.Result;
import com.sky.service.UserService;
import com.sky.utils.JwtUtil;
import com.sky.vo.UserLoginVO;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.HashMap;
import java.util.Map;

@RestController
@RequestMapping("/user/user")
@Api(tags = "c端用户相关接口")
@Slf4j
public class UserController {

    @Autowired
    private UserService userService;

    @Autowired
    private JwtProperties jwtProperties;

    /**
     * 微信登录
     * @param userLoginDTO
     * @return
     */
    @PostMapping("/login")
    @ApiOperation("微信登录")
    public Result<UserLoginVO> login(@RequestBody UserLoginDTO userLoginDTO){
        log.info("微信用户登录，{}",userLoginDTO.getCode());

        //微信登录
        User user = userService.wxLogin(userLoginDTO);

        //为微信用户生成jwt令牌

        Map<String, Object> claims = new HashMap<>();
        claims.put(JwtClaimsConstant.USER_ID,user.getId());
        String token = JwtUtil.createJWT(jwtProperties.getUserSecretKey(), jwtProperties.getUserTtl(), claims);

        UserLoginVO userLoginVO = UserLoginVO.builder()
                .id(user.getId())
                .openid(user.getOpenid())
                .token(token)
                .build();

        return Result.success(userLoginVO);
    }
}

```



```java
package com.sky.service.impl;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import com.sky.constant.MessageConstant;
import com.sky.dto.UserLoginDTO;
import com.sky.entity.User;
import com.sky.exception.LoginFailedException;
import com.sky.mapper.UserMapper;
import com.sky.properties.WeChatProperties;
import com.sky.service.UserService;
import com.sky.utils.HttpClientUtil;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.time.LocalDateTime;
import java.util.HashMap;
import java.util.Map;

@Service
@Slf4j
public class UserServiceImpl implements UserService {

    public static final String WX_LOGIN = "https://api.weixin.qq.com/sns/jscode2session";

    @Autowired
    private WeChatProperties weChatProperties;

    @Autowired
    private UserMapper userMapper;

    /**
     * 微信登录
     * @param userLoginDTO
     * @return
     */
    public User wxLogin(UserLoginDTO userLoginDTO){
        String openid = getOpenId(userLoginDTO.getCode());

        //判断openid是否为空，为空则登录失败，抛出业务异常
        if (openid==null){
            throw new LoginFailedException(MessageConstant.LOGIN_FAILED);
        }

        //判断当前用户是否为新用户
        User user = userMapper.getByOpenId(openid);

        //如果是则自动完成注册
        if(user==null){
            user = User.builder()
                    .openid(openid)
                    .createTime(LocalDateTime.now())
                    .build();
            userMapper.insert(user);
        }

        //返回这个用户对象

        return user;
    }

    /**
     * 调用微信接口访问，获取微信用户的openid
     * @param code
     * @return
     */
    private String getOpenId(String code) {
        //调用微信接口服务，获得当前微信用户的openid
        Map<String, String> map = new HashMap<>();
        map.put("appid",weChatProperties.getAppid());
        map.put("secret",weChatProperties.getSecret());
        map.put("js_code", code);
        map.put("grant_type","authorization_code");
        String json = HttpClientUtil.doGet(WX_LOGIN, map);

        JSONObject jsonObject = JSON.parseObject(json);
        String openid = jsonObject.getString("openid");
        return openid;
    }

}

```



```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sky.mapper.UserMapper">


    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        insert into user (openid, name, phone, sex, id_number, avatar, create_time)
            VALUES (#{openid},#{name},#{phone},#{sex},#{idNumber},#{avatar},#{createTime})
    </insert>
</mapper>

```





## 缓存菜品

### 需求设计与分析

![image-20231024165942126](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024165942126.png)

![image-20231024170038735](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024170038735.png)

![image-20231024170509689](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024170509689.png)



### 代码实现

```java
@PostMapping
    @ApiOperation("新增菜品")
    public Result save(@RequestBody DishDTO dishDTO){
        log.info("新增菜品 {}",dishDTO);
        dishService.saveWishFlavor(dishDTO);

        //清理缓存数据
        String key = "dish_"+dishDTO.getCategoryId();
        cleanCache(key);

        return Result.success();
    }
```



## SpringCache

![image-20231024194321151](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024194321151.png)



### 常用注解

![image-20231024194455456](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024194455456.png)



![image-20231024195123615](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024195123615.png)

![image-20231024195926406](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024195926406.png)



## 缓存套餐

### 代码实现

![image-20231024200018250](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024200018250.png)





```java
  @GetMapping("/list")
    @ApiOperation("根据分类id查询套餐")
    @Cacheable(cacheNames = "setmealCache",key = "#categoryId") //key: setmealCache::100 将方法的返回结果放入缓存
    public Result<List<Setmeal>> list(Long categoryId) {
        Setmeal setmeal = new Setmeal();
        setmeal.setCategoryId(categoryId);
        setmeal.setStatus(StatusConstant.ENABLE);

        List<Setmeal> list = setmealService.list(setmeal);
        return Result.success(list);
    }
```



## 购物车

### 添加购物车

#### 需求分析与设计

![image-20231024201111578](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024201111578.png)

![image-20231024201122383](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024201122383.png)

![image-20231024201232600](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024201232600.png)

![image-20231024201242412](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024201242412.png)

![image-20231024201552161](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024201552161.png)



#### 代码开发

```java
@RestController
@RequestMapping("/user/shoppingCart")
@Slf4j
@Api(tags = "C端购物车相关接口")
public class ShoppingCartController {

    @Autowired
    private ShoppingCartService shoppingCartService;

    /**
     * 添加购物车
     * @param shoppingCartDTO
     * @return
     */
    @PostMapping("/add")
    @ApiOperation("添加购物车")
    public Result add(@RequestBody ShoppingCartDTO shoppingCartDTO){
        log.info("添加购物车,商品信息{}",shoppingCartDTO);
        shoppingCartService.addShoppingCart(shoppingCartDTO);
        return Result.success();
    }
}
```



```java
package com.sky.service.impl;

import com.sky.context.BaseContext;
import com.sky.dto.ShoppingCartDTO;
import com.sky.entity.Dish;
import com.sky.entity.Setmeal;
import com.sky.entity.ShoppingCart;
import com.sky.mapper.DishMapper;
import com.sky.mapper.SetmealMapper;
import com.sky.mapper.ShoppingCartMapper;
import com.sky.service.ShoppingCartService;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.time.LocalDateTime;
import java.util.List;


@Service
@Slf4j
public class ShoppingCartServiceImpl implements ShoppingCartService {

    @Autowired
    private ShoppingCartMapper shoppingCartMapper;

    @Autowired
    private DishMapper dishMapper;

    @Autowired
    private SetmealMapper setmealMapper;

    /**
     * 添加购物车
     * @param shoppingCartDTO
     */
    @Override
    public void addShoppingCart(ShoppingCartDTO shoppingCartDTO) {
        //判断当前加入购物车的商品是否已经存在
        ShoppingCart shoppingCart = new ShoppingCart();
        BeanUtils.copyProperties(shoppingCartDTO,shoppingCart);
        Long userId = BaseContext.getCurrentId(); //从在jwt拦截器设置到ThreadLocal中取出userId
        shoppingCart.setUserId(userId);
        List<ShoppingCart> list = shoppingCartMapper.list(shoppingCart);

        //已经存在，数量加一
        if(list!=null&&list.size()>0){
            ShoppingCart cart = list.get(0);
            cart.setNumber(cart.getNumber()+1); //update shopping_cart set number = ? where id = ?
            shoppingCartMapper.updateNumberById(cart);
        }else{
            //如果不存在，需要插入一条购物车数据
            //判断是菜品还是套餐
            Long dishId = shoppingCart.getDishId();
            if(dishId!=null){
                //添加到购物车的是菜品
                Dish dish = dishMapper.getById(dishId);
                shoppingCart.setName(dish.getName());
                shoppingCart.setImage(dish.getImage());
                shoppingCart.setAmount(dish.getPrice());
            }else{
                //是套餐
                Long setmealId = shoppingCart.getSetmealId();
                Setmeal setmeal = setmealMapper.getById(setmealId);
                shoppingCart.setName(setmeal.getName());
                shoppingCart.setImage(setmeal.getImage());
                shoppingCart.setAmount(setmeal.getPrice());
            }
            shoppingCart.setNumber(1);
            shoppingCart.setCreateTime(LocalDateTime.now());
            shoppingCartMapper.insert(shoppingCart);

        }

    }
}

```





```java
package com.sky.mapper;

import com.sky.entity.ShoppingCart;
import org.apache.ibatis.annotations.Insert;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Update;

import java.util.List;

@Mapper
public interface ShoppingCartMapper {


    /**
     * 动态条件查询
     * @param shoppingCart
     * @return
     */
    List<ShoppingCart> list(ShoppingCart shoppingCart);


    /**
     * 根据id修改商品数量
     * @param shoppingCart
     */
    @Update("update shopping_cart set number = #{number} where id = #{id}")
    void updateNumberById(ShoppingCart shoppingCart);


    /**
     * 插入购物车数据
     * @param shoppingCart
     */
    @Insert("insert into shopping_cart (name, image, user_id, dish_id, setmeal_id, dish_flavor, number, amount, create_time) " +
            "VALUES (#{name},#{image},#{userId},#{dishId},#{setmealId},#{dishFlavor},#{number},#{amount},#{createTime})")
    void insert(ShoppingCart shoppingCart);
}

```



```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sky.mapper.ShoppingCartMapper">


    <select id="list" resultType="com.sky.entity.ShoppingCart">
        select * from shopping_cart
        <where>
            <if test="userId !=null">
                and user_id = #{userId}
            </if>
            <if test="setmealId !=null">
                and setmeal_id = #{setmealId}
            </if>
            <if test="dishId !=null">
                and dish_id = #{dishId}
            </if>
            <if test="dishFlavor !=null">
                and dish_flavor = #{dishFlavor}
            </if>
        </where>
    </select>
</mapper>

```





### 查看购物车

#### 需求分析与设计

![image-20231024210152028](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024210152028.png)

![image-20231024210211613](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024210211613.png)





#### 代码开发

```java

    /**
     * 查看购物车
     * @return
     */
    @GetMapping("/list")
    @ApiOperation("查看购物车")
    public Result<List<ShoppingCart>> list(){
        List<ShoppingCart> list =  shoppingCartService.showShoppingCart();
        return Result.success(list);
    }
```



```java
/**
     * 查看购物车
     * @return
     */
    @Override
    public List<ShoppingCart> showShoppingCart() {
        //获取当前微信用户id
        Long userId= BaseContext.getCurrentId();
        //构造购物车
        ShoppingCart shoppingCart = ShoppingCart.builder()
                .userId(userId)
                .build();
        List<ShoppingCart> list = shoppingCartMapper.list(shoppingCart); //调用mapper查询
        return list;
    }
```





## 地址簿功能

### 需求分析与设计

![image-20231024224704032](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024224704032.png)



#### 

![image-20231024225023271](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024225023271.png)

![image-20231024225135285](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024225135285.png)

![image-20231024225630958](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024225630958.png)

![image-20231024225652397](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024225652397.png)

![image-20231024225717746](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024225717746.png)

![image-20231024225732215](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024225732215.png)

![image-20231024225741513](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024225741513.png)

![image-20231024225753564](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024225753564.png)

![image-20231024225821999](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024225821999.png)



## 用户下单

### 需求设计与分析

![image-20231024230530788](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024230530788.png)

![image-20231024230718598](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024230718598.png)

![image-20231024230910388](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024230910388.png)

![image-20231024231035116](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024231035116.png)

![image-20231024231108620](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024231108620.png)

![image-20231024231312950](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024231312950.png)

![image-20231024231417045](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024231417045.png)

![image-20231024231545765](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024231545765.png)



### 代码开发

![image-20231024231607281](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024231607281.png)

![image-20231024231625663](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231024231625663.png)





## 微信支付

### 支付流程

![image-20231026110704353](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026110704353.png)



### 准备工作

![image-20231026111456007](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026111456007.png)

![image-20231026111506299](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026111506299.png)







## Spring Task

![image-20231026165538832](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026165538832.png)

![image-20231026165610889](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026165610889.png)



### cron表达式

![image-20231026165656957](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026165656957.png)

![image-20231026165703037](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026165703037.png)



### 使用案例

![image-20231026165749534](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026165749534.png)





## 订单状态定时处理

![image-20231026172719097](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026172719097.png)

![image-20231026172818491](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026172818491.png)





## WebSocket

![image-20231026210400110](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026210400110.png)

![image-20231026210437146](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026210437146.png)



### 入门案例

![image-20231026215657320](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026215657320.png)



```html
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title>WebSocket Demo</title>
</head>
<body>
    <input id="text" type="text" />
    <button onclick="send()">发送消息</button>
    <button onclick="closeWebSocket()">关闭连接</button>
    <div id="message">
    </div>
</body>
<script type="text/javascript">
    var websocket = null;
    var clientId = Math.random().toString(36).substr(2);

    //判断当前浏览器是否支持WebSocket
    if('WebSocket' in window){
        //连接WebSocket节点
        websocket = new WebSocket("ws://localhost:8080/ws/"+clientId);
    }
    else{
        alert('Not support websocket')
    }

    //连接发生错误的回调方法
    websocket.onerror = function(){
        setMessageInnerHTML("error");
    };

    //连接成功建立的回调方法
    websocket.onopen = function(){
        setMessageInnerHTML("连接成功");
    }

    //接收到消息的回调方法
    websocket.onmessage = function(event){
        setMessageInnerHTML(event.data);
    }

    //连接关闭的回调方法
    websocket.onclose = function(){
        setMessageInnerHTML("close");
    }

    //监听窗口关闭事件，当窗口关闭时，主动去关闭websocket连接，防止连接还没断开就关闭窗口，server端会抛异常。
    window.onbeforeunload = function(){
        websocket.close();
    }

    //将消息显示在网页上
    function setMessageInnerHTML(innerHTML){
        document.getElementById('message').innerHTML += innerHTML + '<br/>';
    }

    //发送消息
    function send(){
        var message = document.getElementById('text').value;
        websocket.send(message);
    }
	
	//关闭连接
    function closeWebSocket() {
        websocket.close();
    }
</script>
</html>

```



- maven

```xml
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-websocket</artifactId>
</dependency>
```





- WebSocketConfiguration

```java
package com.sky.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.socket.server.standard.ServerEndpointExporter;

/**
 * WebSocket配置类，用于注册WebSocket的Bean
 */
@Configuration
public class WebSocketConfiguration {

    @Bean
    public ServerEndpointExporter serverEndpointExporter() {
        return new ServerEndpointExporter();
    }

}

```



- WebSocketServer

```java
package com.sky.websocket;

import org.springframework.stereotype.Component;
import javax.websocket.OnClose;
import javax.websocket.OnMessage;
import javax.websocket.OnOpen;
import javax.websocket.Session;
import javax.websocket.server.PathParam;
import javax.websocket.server.ServerEndpoint;
import java.util.Collection;
import java.util.HashMap;
import java.util.Map;

/**
 * WebSocket服务
 */
@Component
@ServerEndpoint("/ws/{sid}")
public class WebSocketServer {

    //存放会话对象
    private static Map<String, Session> sessionMap = new HashMap();

    /**
     * 连接建立成功调用的方法
     */
    @OnOpen
    public void onOpen(Session session, @PathParam("sid") String sid) {
        System.out.println("客户端：" + sid + "建立连接");
        sessionMap.put(sid, session);
    }

    /**
     * 收到客户端消息后调用的方法
     *
     * @param message 客户端发送过来的消息
     */
    @OnMessage
    public void onMessage(String message, @PathParam("sid") String sid) {
        System.out.println("收到来自客户端：" + sid + "的信息:" + message);
    }

    /**
     * 连接关闭调用的方法
     *
     * @param sid
     */
    @OnClose
    public void onClose(@PathParam("sid") String sid) {
        System.out.println("连接断开:" + sid);
        sessionMap.remove(sid);
    }

    /**
     * 群发
     *
     * @param message
     */
    public void sendToAllClient(String message) {
        Collection<Session> sessions = sessionMap.values();
        for (Session session : sessions) {
            try {
                //服务器向客户端发送消息
                session.getBasicRemote().sendText(message);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }

}

```



- WebSocketTask

```java
package com.sky.task;

import com.sky.websocket.WebSocketServer;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;

@Component
public class WebSocketTask {
    @Autowired
    private WebSocketServer webSocketServer;

    /**
     * 通过WebSocket每隔5秒向客户端发送消息
     */
    @Scheduled(cron = "0/5 * * * * ?")
    public void sendMessageToClient() {
        webSocketServer.sendToAllClient("这是来自服务端的消息：" + DateTimeFormatter.ofPattern("HH:mm:ss").format(LocalDateTime.now()));
    }
}

```





## 来单提醒

### 需求分析和设计

![image-20231026220623792](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026220623792.png)

![image-20231026223951175](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026223951175.png)	



## 客户催单

### 需求分析与设计

![image-20231026230128526](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026230128526.png)

![image-20231026230152631](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231026230152631.png)









# 前端

## vue复习

### 基于脚手架创建前端工程

#### 创建

![image-20231030220311079](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030220311079.png)

![image-20231030161304311](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030161304311.png)



#### 启动前端项目



​	![image-20231030220235872](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030220235872.png)



#### 修改端口

![image-20231030220507137](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030220507137.png)

![image-20231030220636101](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030220636101.png)



### vue基本使用

##### vue组件

![image-20231030220822668](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030220822668.png)





#### 文本插值

![image-20231030220953168](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030220953168.png)



#### 属性绑定

![image-20231030221724796](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030221724796.png)



#### 事件绑定

![image-20231030222045738](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030222045738.png)



#### 双向绑定

![image-20231030222428298](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030222428298.png)



#### 条件渲染

![image-20231030222852420](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030222852420.png)



#### axios

![image-20231030223354883](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030223354883.png)

![image-20231030223502743](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030223502743.png)



- 如果不配置代理会出现跨域问题

![image-20231030224148286](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030224148286.png)

![image-20231030223527392](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030223527392.png)

![image-20231030224413696](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030224413696.png)



- 修改完config需要重启才能生效

![image-20231030224806380](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030224806380.png)

![image-20231030225804712](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030225804712.png)

![image-20231030230358868](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030230358868.png)

```javascript
 axiox({
        method: 'post',
        url: '/api/admin/employee/login',
        data: {  //data:请求体
          username: 'admin',
          password: '123456'
        }
      }).then(res => {
        console.log(res.data)
        this.token = res.data.data.token
      }).catch(error => {
        console.log(error.response)
      })
```

![image-20231030230458454](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231030230458454.png)



### Vue路由

![image-20231031160626797](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031160626797.png)

![image-20231031160739603](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031160739603.png)

![image-20231031160750849](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031160750849.png)

![image-20231031160755199](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031160755199.png)





#### 路由配置

![image-20231031161024098](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031161024098.png)

![image-20231031161530908](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031161530908.png)

![image-20231031161557714](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031161557714.png)

![image-20231031161821106](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031161821106.png)

![image-20231031161833713](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031161833713.png)



#### 嵌套路由

![image-20231031162025411](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031162025411.png)

![image-20231031164802627](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031164802627.png)

![image-20231031164829476](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031164829476.png)

![image-20231031164904235](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031164904235.png)



### 状态管理vuex

![image-20231031165038969](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031165038969.png)

![image-20231031165045470](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031165045470.png)

#### 使用

![image-20231031165338925](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031165338925.png)

![image-20231031170043520](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031170043520.png)

  ![image-20231031194255817](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031194255817.png)

![image-20231031194350420](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031194350420.png)



![image-20231031194546389](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031194546389.png)



![image-20231031194603527](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031194603527.png)





![image-20231031194521464](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031194521464.png)







### TypeScript

![image-20231031194741873](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031194741873.png)

![image-20231031194844801](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031194844801.png)

![image-20231031195237441](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031195237441.png)

![image-20231031195325882](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031195325882.png)

![image-20231031195339684](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031195339684.png)



### ts常用数据类型

![image-20231031195425240](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031195425240.png)

![image-20231031195526107](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031195526107.png)

![image-20231031195846552](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031195846552.png)





#### 字符串类型、数字类型、布尔类型

![image-20231031200048128](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031200048128.png)



#### 字面量类型

![image-20231031200112924](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031200112924.png)



#### interface类型

![image-20231031200226865](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031200226865.png)

![image-20231031200301774](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031200301774.png)





#### class类型

![image-20231031200419836](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031200419836.png)





##### class实现接口

![image-20231031200647061](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031200647061.png)



##### class类的继承

![image-20231031201649359](C:\Users\admin\Desktop\学习\笔记\苍穹外卖.assets\image-20231031201649359.png)
